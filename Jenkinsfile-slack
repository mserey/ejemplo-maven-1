import groovy.json.JsonSlurperClassic

def jsonParse(def json) {
    new groovy.json.JsonSlurperClassic().parseText(json)
}
pipeline {
    agent any
    stages {
        stage('STAGE TEST') {
            steps {
                script{
                    env.STAGE='STAGE TEST'
                    sh 'echo "Testins stage && Slack"'
                    sh 'ssh root:122.21.12.12' para generar fallo
                }
            }
			post{
				success{
					slackSend color: 'good', message: "[Mentor Devops] [${JOB_NAME}] [${BUILD_TAG}] Ejecucion Exitosa", teamDomain: 'devopsusach20-lzc3526', tokenCredentialId: 'token-slack'
				}
				failure{
					slackSend color: 'danger', message: "[Mentor Devops] [${env.JOB_NAME}] [${BUILD_TAG}] Ejecucion fallida en stage [${env.STAGE}]", teamDomain: 'devopsusach20-lzc3526', tokenCredentialId: 'token-slack'
				}
			}
        }
    }
}